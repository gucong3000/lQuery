<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>lQuery</title>
<style>
.prettyprint .linenums li {
	list-style-type: inherit;
}
</style>
<script src="lQuery.js"></script>
<script>
(function($){
	var q;
	
	function run(){
		die();
		q = $(".test2").each(function(){
			this.innerHTML = "test11";
		}).style("color: red;");
		return false;
	}
	
	function die(){
		if(q){
			q = q.die();
		}
		return false;
	}
	
	$(".run").each(function(){
		this.onclick = run;
	});
	
	$(".die").each(function(){
		this.onclick = die;
	});

	$(".add").each(function(){
		this.onclick = function(){
			var doc = document,
				div = doc.createElement("div");
			div.setAttribute("class", "test2");
			div.className = "test2";
			div.innerHTML = "new node";
			doc.getElementById("testers").appendChild(div);
			return false;
		};
	});

	run();
})(lQuery);
</script>
</head>
<body>
<div id="testers">
	<div class="test1">test</div>
	<div class="test2">test2</div>
	<div class="test1">test</div>
	<div class="test2">test2</div>
	<div class="test1">test</div>
	<div class="test2">test2</div>
</div>

<div>
	<a href="#" class="run">开始动态查找</a>
	<a href="#" class="die">停止动态查找</a>
	<a href="#" class="add">动态添加节点</a>
</div>
<pre class="prettyprint linenums">
(function($){
	var q;
	
	function run(){
		die();
		q = $(".test2").each(function(){
			this.innerHTML = "test11";
		}).style("color: red;");
		return false;
	}
	
	function die(){
		if(q){
			q = q.die();
		}
		return false;
	}
	
	$(".run").each(function(){
		this.onclick = run;
	});
	
	$(".die").each(function(){
		this.onclick = die;
	});

	$(".add").each(function(){
		this.onclick = function(){
			var doc = document,
				div = doc.createElement("div");
			div.setAttribute("class", "test2");
			div.className = "test2";
			div.innerHTML = "new node";
			doc.getElementById("testers").appendChild(div);
			return false;
		};
	});

	run();
})(lQuery);
</script>
</pre>
<link rel="Stylesheet" type="text/css" href="http://google-code-prettify.googlecode.com/svn/trunk/src/prettify.css">
<script type="text/javascript"  src="http://google-code-prettify.googlecode.com/svn/trunk/src/prettify.js"></script> 
<script>
prettyPrint();
</script>
</body>
</html>
